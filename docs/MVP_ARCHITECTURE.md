# NewsBrief MVP Architecture (2-Service Model, No Queue)

## Simplified Service Layout

```
┌──────────────────────────────────┐
│          Core API (Go Gin)       │
│ • Auth & User Management         │
│ • Story & Feed Management        │
│ • Summarization (Gemini API)     │
│ • Daily Brief Generation         │
│ • Notifications                  │
│ • Embedding (Pinecone)           │
└───────────────┬──────────────────┘
                │ HTTP
                ▼
┌───────────────┴──────────────────┐
│          Scraper (FastAPI)       │
│ • Content Extraction             │
│ • Article Metadata               │
└───────────────┬──────────────────┘
                │
                ▼
┌───────────────┴──────────────────┐
│         External Services        │
│ • MongoDB (Data Persistence)     │
│ • Pinecone (Vector DB)           │
└──────────────────────────────────┘
```

## MVP Feature Scope (Consolidated)

### ✅ Core API Responsibilities

- Registration/Login/JWT, password management
- User preferences: topics add/remove, subscriptions add/remove
- Feed and story endpoints
- Summarization, embedding, and search (text + semantic)
- Daily briefs and notifications (simple email/in-app)

### ✅ Scraper Responsibilities

- `POST /v1/scrape` endpoint to extract clean text + metadata from a URL

## Synchronous Flow (No RabbitMQ)

1. Core API receives a new URL to ingest (cron or admin trigger).
2. Core API calls Scraper HTTP: `POST {SCRAPER_BASE_URL}/v1/scrape`.
3. Core API summarizes, embeds, stores in MongoDB and Pinecone.
4. Daily briefs generated by Core API scheduler; notifications sent inline or via lightweight goroutines.

## MongoDB Collections (MVP)

- users (preferences.topics, subscriptions)
- tokens (verify/reset/refresh)
- stories (content, summaries, tags, source)
- sources (catalogue of outlets)
- topics (catalogue with labels/images)
- daily_briefs (per user, morning/evening)
- notifications (in-app notification records)

## Deployment (Render Free Tier)

- 2 Web Services: core-api (Go), scraper (Python)
- 1 MongoDB (Render Free DB) or MongoDB Atlas Free
- Pinecone Free tier for embeddings
- No RabbitMQ required

Example env vars:

- CORE API: MONGODB_URI, SCRAPER_BASE_URL, PINECONE_API_KEY, GEMINI_API_KEY, JWT_SECRET
- SCRAPER: LOG_LEVEL

## Scaling Later

- If throughput grows, add RabbitMQ/Kafka and reintroduce async workers
- Split summarization/notifications into dedicated services
- Add Redis for caching and rate-limiting
